{
  "id": "com.elinaexperience.qapp",
  "name": "Elina experience",
  "description": "ngobrol singkat bareng Elina yuk! :)",
  "icon": "fa-comment",
  "color": "#ffa8a8",
  "version": "2.0",
  "html": "<!DOCTYPE html>\n<html lang=\"id\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Victra Project: Elina Romance</title>\n    <link href=\"https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;1,400&display=swap\" rel=\"stylesheet\">\n    \n    <style>\n        /* --- CORE STYLES --- */\n        body { background-color: #000; color: #e0e0e0; font-family: 'Lora', serif; margin: 0; height: 100vh; overflow: hidden; text-align: center; user-select: none; }\n        \n        /* VIDEO BACKGROUND */\n        #bg-video {\n            position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n            object-fit: cover; z-index: -2; opacity: -2; transition: opacity 2s ease;\n            filter: brightness(0.3) contrast(0.9);\n        }\n        #bg-video.active { opacity: 0.6; }\n\n        /* SPLASH SCREEN */\n        #splash-screen {\n            position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n            background: #000; z-index: 2000; display: flex; justify-content: center; align-items: center; cursor: pointer;\n        }\n        .splash-text { font-size: 0.9rem; letter-spacing: 3px; animation: pulse 2s infinite; color: #888; }\n\n        /* MAIN MENU */\n        #main-menu {\n            position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n            z-index: 1000; display: flex; flex-direction: column; justify-content: center; align-items: center;\n            background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(3px);\n            opacity: 0; visibility: hidden; transition: opacity 1.5s ease;\n        }\n        #main-menu.show { opacity: 1; visibility: visible; }\n        .menu-title { font-size: 3.5rem; margin-bottom: 5px; text-shadow: 0 0 30px rgba(255,255,255,0.3); letter-spacing: 6px; }\n        .menu-btn {\n            background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.2);\n            color: #ccc; padding: 15px 0; margin: 8px; width: 220px; transition: all 0.3s ease; cursor: pointer;\n        }\n        .menu-btn:hover { background: rgba(255, 255, 255, 0.15); border-color: #fff; color: #fff; }\n\n        /* CHAT UI */\n        #container { \n            width: 90%; max-width: 600px; height: 100vh; \n            position: relative; display: flex; flex-direction: column; \n            align-items: center; justify-content: center; margin: 0 auto;\n            opacity: 0; visibility: hidden; transition: opacity 2s ease;\n        }\n\n        /* WAJAH ASCII BESAR */\n        #face { \n            position: absolute; top: 15%; font-size: 4.5rem; color: #fff; \n            text-shadow: 0 0 40px rgba(255, 255, 255, 0.15); height: 80px; \n            opacity: 0; transition: opacity 2s ease; letter-spacing: 2px; font-weight: 500; z-index: 10; \n        }\n        \n        .text-content { \n            position: absolute; top: 50%; transform: translateY(-50%); \n            font-size: 1.3rem; line-height: 1.6; opacity: 0; transition: opacity 0.5s ease; \n            max-width: 85%; text-shadow: 0 0 15px rgba(0,0,0,0.8); \n        }\n        .text-content.show { opacity: 1; }\n        \n        .input-area { position: absolute; bottom: 18%; width: 100%; height: 60px; display: flex; justify-content: center; align-items: center; flex-direction: column; }\n        #reply-btn { background: transparent; border: 1px solid #444; color: #888; padding: 12px 35px; border-radius: 50px; cursor: pointer; opacity: 0; pointer-events: none; transition: all 0.3s ease; }\n        #reply-btn.visible { opacity: 1; pointer-events: all; }\n        \n        input[type=\"text\"] { background: transparent; border: none; border-bottom: 1px solid #555; color: white; font-family: 'Lora', serif; font-size: 1.2rem; text-align: center; padding: 10px; outline: none; width: 0%; opacity: 0; transition: all 0.5s; }\n        input[type=\"text\"].active { width: 85%; opacity: 1; border-bottom: 1px solid #fff; }\n        \n        .loading-dots { font-size: 2rem; animation: pulse 1s infinite; color: #555; }\n        @keyframes pulse { 0% {opacity:0.3;} 50% {opacity:1;} 100% {opacity:0.3;} }\n\n        /* SETTINGS MODAL */\n        #settings-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #111; padding: 30px; border: 1px solid #333; z-index: 3000; width: 80%; max-width: 300px; }\n    </style>\n</head>\n<body>\n\n    <div id=\"splash-screen\" onclick=\"enterApplication()\"><div class=\"splash-text\">[ ketuk layar ]</div></div>\n\n    <video id=\"bg-video\" loop muted playsinline>\n        <!-- PASTE LINK VIDEO KAMU DISINI -->\n        <source src=\"https://files.catbox.moe/3qrvea.mp4\" type=\"video/mp4\">\n    </video>\n\n    <audio id=\"sfx\"><source src=\"type.mp3\" type=\"audio/mpeg\"></audio>\n\n    <div id=\"main-menu\">\n        <div class=\"menu-title\">ELINA</div>\n        <button class=\"menu-btn\" onclick=\"startGame()\">Mulai</button>\n        <button class=\"menu-btn\" onclick=\"openSettings()\">Pengaturan AI</button>\n    </div>\n\n    <div id=\"settings-modal\">\n        <input type=\"password\" id=\"api-key-input\" placeholder=\"API Key...\" style=\"width:100%; padding:10px; margin-bottom:10px;\">\n        <button class=\"menu-btn\" onclick=\"saveSettings()\" style=\"width:100%\">Simpan</button>\n        <div style=\"text-align:center; margin-top:10px; color:#555; cursor:pointer;\" onclick=\"closeSettings()\">[ batal ]</div>\n    </div>\n\n    <div id=\"container\">\n        <div id=\"face\">• _ •</div>\n        <div id=\"main-text\" class=\"text-content\"></div>\n        <div class=\"input-area\">\n            <button id=\"reply-btn\" onclick=\"openKeyboard()\">[ ketuk untuk bicara ]</button>\n            <input type=\"text\" id=\"user-input\" autocomplete=\"off\">\n        </div>\n    </div>\n\n    <script>\n        // --- KONFIGURASI ---\n        let API_KEY = \"AIzaSyCZjQtsJGwFU-2hhZYMuCxT4-Yr1gZDI-4\"; \n        const playlistUrls = [\"https://files.catbox.moe/vq9nb3.mp3\", \"https://files.catbox.moe/64zetf.mp3\"];\n\n        let userName = \"\";\n        let chatHistory = [];\n        let rivals = []; \n        let audioPool = [];\n        let currentTrackIndex = 0;\n        let lastMoodState = 'neutral';\n\n        // Elements\n        const splashScreen = document.getElementById('splash-screen');\n        const mainMenu = document.getElementById('main-menu');\n        const bgVideo = document.getElementById('bg-video');\n        const container = document.getElementById('container');\n        const faceEl = document.getElementById('face');\n        const mainText = document.getElementById('main-text');\n        const replyBtn = document.getElementById('reply-btn');\n        const inputField = document.getElementById('user-input');\n        const sfx = document.getElementById('sfx');\n\n        // --- MENU ---\n        function enterApplication() {\n            splashScreen.style.display = 'none';\n            mainMenu.classList.add('show');\n            bgVideo.play().catch(e=>{}); bgVideo.classList.add('active');\n            preloadMusic();\n        }\n        function startGame() {\n            mainMenu.classList.remove('show');\n            setTimeout(() => { mainMenu.style.display = 'none'; container.style.visibility = 'visible'; container.style.opacity = 1; }, 1000);\n            if (document.documentElement.requestFullscreen) document.documentElement.requestFullscreen().catch(e=>{});\n            unlockAudioEngine();\n            setTimeout(introSequence, 1000);\n        }\n        function openSettings() { document.getElementById('settings-modal').style.display = 'block'; document.getElementById('api-key-input').value = API_KEY; }\n        function closeSettings() { document.getElementById('settings-modal').style.display = 'none'; }\n        function saveSettings() { API_KEY = document.getElementById('api-key-input').value.trim(); closeSettings(); alert(\"Tersimpan.\"); }\n\n        // --- AUDIO ---\n        function preloadMusic() { playlistUrls.forEach(u => { let a = new Audio(u); a.volume = 0.5; a.addEventListener('ended', playNextTrack); audioPool.push(a); }); }\n        function playNextTrack() { currentTrackIndex = (currentTrackIndex + 1) % audioPool.length; audioPool[currentTrackIndex].play(); }\n        function unlockAudioEngine() { if(audioPool.length) audioPool.forEach(a => { a.volume=0; a.play().then(()=>{a.pause(); a.volume=0.5;}); }); }\n        function startBGM() { if(audioPool.length) audioPool[currentTrackIndex].play(); }\n\n        // --- FACE & TYPING ---\n        const faces = { \n            neutral: \"• _ •\", happy: \"◠ ‿ ◠\", sad: \"• ︵ •\", cry: \"T _ T\", listen: \"• . •\", \n            shock: \"O _ O\", thinking: \"• - •\", shy: \"> /// <\", jealous: \"¬ _ ¬\", \n            sleepy: \"￣ ρ ￣\", angry: \"` ^ ´\", love: \"♥ ‿ ♥\", smug: \"￣ ‿ ￣\"\n        };\n        \n        function setFace(mood) { \n            if(faces[mood]) { faceEl.innerHTML = faces[mood]; lastMoodState = mood; }\n            else { faceEl.innerHTML = faces[lastMoodState]; }\n        }\n\n        function typeSegment(text, callback) {\n            mainText.innerHTML = \"\"; mainText.classList.add('show');\n            let i = 0; let speed = (lastMoodState === 'sad') ? 50 : 35;\n            function type() {\n                if(i < text.length) { \n                    mainText.innerHTML += text.charAt(i); \n                    if(Math.random()>0.3) { sfx.currentTime=0; sfx.play().catch(()=>{}); }\n                    i++; setTimeout(type, speed);\n                } else if(callback) callback();\n            } type();\n        }\n\n        // --- INTRO ---\n        function introSequence() {\n            let q = [{t:\"hai...\", m:\"neutral\"}, {t:\"senang kamu disini.\", m:\"happy\"}, {t:\"aku elina.\", m:\"shy\"}];\n            let i = 0;\n            function next() {\n                if(i < q.length) {\n                    setFace(q[i].m);\n                    mainText.innerHTML = q[i].t; mainText.classList.add('show');\n                    setTimeout(() => { mainText.classList.remove('show'); setTimeout(() => { i++; next(); }, 500); }, 2000);\n                } else {\n                    setFace('happy'); faceEl.style.opacity = 1;\n                    mainText.innerHTML = \"siapa nama panggilanmu?\"; mainText.classList.add('show');\n                    setTimeout(() => { replyBtn.innerHTML = \"[ ketuk disini ]\"; replyBtn.classList.add('visible'); }, 1000);\n                }\n            } next();\n        }\n\n        // --- PARSER CHAT (LOGIKA UTAMA) ---\n        function playMessageQueue(messages) {\n            if (messages.length === 0) { setTimeout(() => { replyBtn.innerHTML = \"[ balas ]\"; replyBtn.classList.add('visible'); }, 300); return; }\n            \n            let raw = messages.shift();\n            \n            // 1. DETEKSI & UPDATE WAJAH (Visual Jalan)\n            if (raw.includes('[SENYUM]')) setFace('happy');\n            else if (raw.includes('[SEDIH]')) setFace('sad');\n            else if (raw.includes('[KAGET]')) setFace('shock');\n            else if (raw.includes('[MALU]')) setFace('shy');\n            else if (raw.includes('[MARAH]')) setFace('angry');\n            else if (raw.includes('[LOVE]')) setFace('love');\n            else if (raw.includes('[SMUG]')) setFace('smug');\n            else if (raw.includes('[DENGAR]')) setFace('listen');\n            else if (raw.includes('[NANGIS]')) setFace('cry');\n            else setFace(lastMoodState); // Keep last mood\n\n            // 2. BERSIHKAN TEKS UNTUK BUBBLE CHAT (Tag Hilang)\n            let cleanText = raw.replace(/\\[.*?\\]/g, \"\").replace(/\\(.*?\\)/g, \"\").trim().toLowerCase();\n            \n            if(!cleanText) { playMessageQueue(messages); return; }\n\n            mainText.classList.remove('show');\n            setTimeout(() => {\n                typeSegment(cleanText, () => {\n                    let wait = 1000 + (cleanText.length * 60);\n                    setTimeout(() => playMessageQueue(messages), wait);\n                });\n            }, 600);\n        }\n\n        // --- INPUT & AI ---\n        function openKeyboard() { replyBtn.classList.remove('visible'); inputField.style.display=\"block\"; setTimeout(()=>inputField.classList.add('active'),50); inputField.focus(); }\n        inputField.onkeydown = (e) => {\n            if(e.key==='Enter') {\n                let val = inputField.value.trim();\n                inputField.classList.remove('active'); setTimeout(()=>inputField.style.display=\"none\",500); inputField.value=\"\";\n                if(!userName) { userName=val; mainText.classList.remove('show'); setTimeout(()=>{startBGM(); initAI();},800); }\n                else processInput(val);\n            }\n        };\n\n        // --- BATERAI ---\n        async function checkBattery(msg) {\n            if(!msg.match(/baterai|battery|batere|charge/i)) return false;\n            setFace('thinking'); mainText.classList.remove('show');\n            try {\n                let b = await navigator.getBattery(); let l = Math.round(b.level*100);\n                let txt = b.charging ? `[SENYUM] lagi dicharge kan? ${l}%. | [SMUG] bagus.` : \n                          (l>20 ? `[SENYUM] aman kok ${l}%.` : `[KAGET] eh tinggal ${l}%! | [SEDIH] charge dong.`);\n                setTimeout(()=>playMessageQueue(txt.split('|')), 500); return true;\n            } catch(e) { return false; }\n        }\n\n        function initAI() {\n            chatHistory.push({ role: \"user\", parts: [{ text: `Roleplay: Kamu ELINA, pacar virtual user: ${userName}. Sifat: Peka, manja, ekspresif. ATURAN: 1. AWALI TIAP KALIMAT DENGAN TAG EMOSI [SENYUM]/[SEDIH]/[MARAH]/[MALU]/[LOVE]. 2. GUNAKAN '|' UNTUK JEDA.` }] });\n            callGemini(null);\n        }\n\n        async function processInput(msg) {\n            if(await checkBattery(msg)) return;\n            setFace('thinking'); mainText.classList.remove('show');\n            setTimeout(() => { mainText.innerHTML = '<span class=\"loading-dots\">...</span>'; mainText.classList.add('show'); }, 500);\n            \n            let mem = rivals.length ? ` [RIVAL: ${rivals.join(\",\")}]` : \"\";\n            chatHistory.push({ role: \"user\", parts: [{ text: msg + mem + \" (Ingat: Pakai tag emosi di awal, pisahkan kalimat pakai '|')\" }] });\n            callGemini(msg);\n        }\n\n        async function callGemini() {\n            try {\n                let r = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-flash-lite-latest:generateContent?key=${API_KEY}`, {\n                    method: \"POST\", headers: {\"Content-Type\":\"application/json\"},\n                    body: JSON.stringify({ contents: chatHistory })\n                });\n                let d = await r.json();\n                let txt = d.candidates[0].content.parts[0].text.trim();\n                \n                // Rival Logic\n                if(txt.includes(\"||INGAT:\")) { \n                    let n = txt.split(\"||INGAT:\")[1].split(\"||\")[0]; \n                    if(!rivals.includes(n)) rivals.push(n); \n                    txt = txt.replace(/\\|\\|INGAT:.*?\\|\\|/g, \"\"); \n                }\n\n                // Force Splitter\n                if(!txt.includes('|')) txt = txt.replace(/([.?!])\\s+/g, '$1|');\n                \n                chatHistory.push({ role: \"model\", parts: [{ text: txt }] });\n                playMessageQueue(txt.split('|').filter(s=>s.trim()));\n\n            } catch(e) {\n                playMessageQueue([\"[SEDIH] sinyal aku jelek... | [NANGIS] ulangi dong sayang.\"]);\n            }\n        }\n    </script>\n</body>\n</html>",
  "script": ""
}